<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Análisis de Partidos</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
  --bg:#0f172a;
  --card:#020617;
  --text:#e5e7eb;
  --muted:#94a3b8;
  --border:#1e293b;
  --accent:#22c55e;
}

*{box-sizing:border-box}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui;
}
.container{max-width:1200px;margin:auto;padding:16px}
.card{
  background:var(--card);
  border:1px solid var(--border);
  border-radius:12px;
  padding:16px;
  margin-bottom:16px;
}
input,button{
  background:#020617;
  color:var(--text);
  border:1px solid var(--border);
  border-radius:8px;
  padding:8px;
  width:100%;
}
button{
  background:var(--accent);
  color:#022c22;
  font-weight:700;
  cursor:pointer;
}
.grid{
  display:grid;
  gap:8px;
  grid-template-columns:repeat(auto-fit,minmax(120px,1fr));
}
.table{
  width:100%;
  border-collapse:collapse;
  font-size:12px;
}
.table th,.table td{
  border:1px solid var(--border);
  padding:6px;
  text-align:center;
}
.table th{color:var(--muted)}
.small{font-size:11px;color:var(--muted)}
@media(max-width:600px){
  .table{font-size:10px}
}
</style>
</head>

<body>
<div class="container">

<!-- PARTIDO -->
<div class="card">
<h2>Partido (A - B)</h2>
<div class="grid">
<input id="teamA" placeholder="Equipo A">
<input id="teamB" placeholder="Equipo B">
</div>
</div>

<!-- ENCUENTRO -->
<div class="card">
<h3>Agregar Encuentro</h3>
<div class="grid">
<input id="competencia" placeholder="Competencia">

<input id="ttA" placeholder="Tiros Totales A">
<input id="ttB" placeholder="Tiros Totales B">

<input id="tapA" placeholder="A Puerta A">
<input id="tapB" placeholder="A Puerta B">

<input id="corA" placeholder="Corners A">
<input id="corB" placeholder="Corners B">

<input id="tarA" placeholder="Tarjetas A">
<input id="tarB" placeholder="Tarjetas B">

<input id="golA" placeholder="Goles A">
<input id="golB" placeholder="Goles B">
</div>
<br>
<button onclick="addMatch()">AÑADIR ENCUENTRO</button>
</div>

<!-- HISTORIAL -->
<div class="card">
<h3>Historial</h3>
<table class="table" id="tabla">
<thead>
<tr>
<th>Partido</th>
<th>Competencia</th>
<th>TT (A|B)</th>
<th>AP (A|B)</th>
<th>COR (A|B)</th>
<th>TAR (A|B)</th>
<th>GOL (A|B)</th>
</tr>
</thead>
<tbody></tbody>
<tfoot>
<tr><th colspan="2">TOTAL</th>
<th id="t1"></th><th id="t2"></th><th id="t3"></th><th id="t4"></th><th id="t5"></th></tr>
<tr><th colspan="2">PROMEDIO</th>
<th id="p1"></th><th id="p2"></th><th id="p3"></th><th id="p4"></th><th id="p5"></th></tr>
<tr><th colspan="2">PROBABILIDAD</th>
<th id="pr1"></th><th id="pr2"></th><th id="pr3"></th><th id="pr4"></th><th id="pr5"></th></tr>
</tfoot>
</table>
</div>

</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyBtOk-otWrGU7ljda52yhVhSvQKaG3siRM",
  authDomain: "apuestas-analisis.firebaseapp.com",
  projectId: "apuestas-analisis",
  storageBucket: "apuestas-analisis.firebasestorage.app",
  messagingSenderId: "542021066839",
  appId: "1:542021066839:web:bb6a43f578a39d07c68312"
};
firebase.initializeApp(firebaseConfig);
const db=firebase.firestore();
const ref=db.collection("analisis");

let data=[];

function addMatch(){
  const m={
    equipoA:teamA.value,
    equipoB:teamB.value,
    competencia:competencia.value,
    stats:{
      tt:{A:+ttA.value,B:+ttB.value},
      tap:{A:+tapA.value,B:+tapB.value},
      cor:{A:+corA.value,B:+corB.value},
      tar:{A:+tarA.value,B:+tarB.value},
      gol:{A:+golA.value,B:+golB.value}
    }
  };
  ref.add(m);
}

ref.onSnapshot(s=>{
  data=[];
  s.forEach(d=>data.push(d.data()));
  render();
});

function render(){
  const tb=document.querySelector("#tabla tbody");
  tb.innerHTML="";
  let t=[0,0,0,0,0];

data.forEach(m=>{
  const s = m.stats || {
    tt:{A:0,B:0},
    tap:{A:0,B:0},
    cor:{A:0,B:0},
    tar:{A:0,B:0},
    gol:{A:0,B:0}
  };

  tb.innerHTML+=`
  <tr>
    <td>${m.equipoA || "—"} vs ${m.equipoB || "—"}</td>
    <td>${m.competencia || "—"}</td>
    <td>${s.tt.A}|${s.tt.B}</td>
    <td>${s.tap.A}|${s.tap.B}</td>
    <td>${s.cor.A}|${s.cor.B}</td>
    <td>${s.tar.A}|${s.tar.B}</td>
    <td>${s.gol.A}|${s.gol.B}</td>
  </tr>`;

  t[0]+=s.tt.A+s.tt.B;
  t[1]+=s.tap.A+s.tap.B;
  t[2]+=s.cor.A+s.cor.B;
  t[3]+=s.tar.A+s.tar.B;
  t[4]+=s.gol.A+s.gol.B;
});


  ["t1","t2","t3","t4","t5"].forEach((id,i)=>document.getElementById(id).textContent=t[i]);
  ["p1","p2","p3","p4","p5"].forEach((id,i)=>document.getElementById(id).textContent=(t[i]/data.length||0).toFixed(1));
  const sum=t.reduce((a,b)=>a+b,0)||1;
  ["pr1","pr2","pr3","pr4","pr5"].forEach((id,i)=>document.getElementById(id).textContent=((t[i]/sum)*100).toFixed(1)+"%");
}
</script>
</body>
</html>
